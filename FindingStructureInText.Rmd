---
title: "Text_TDA"
author: "Matt O'Reilly"
date: "1/1/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(nonlinearTseries)
library(TDAstats)
library(tidyverse)
library(dplyr)
```

```{r}
text_data <- read.csv("./data/text_vector.csv")
text_vector_data <- text_data %>% select(wordcountvec)

text <- data_frame()
for (i in 1:length(text_vector_data)){
  for (digit in i){
    text_df <- rbind(digit, text)
  }
}
text_df
```

```{r}
text_homology <- data.frame()
#length(text_data['wordcountvec']
for (i in 1:3){
text_vector_matrix <- data.matrix(text_vector_data[,i])
tak <- buildTakens(text_vector_matrix,2,3)
plot(tak)
hom <- calculate_homology(tak,return_df = TRUE) 
hom_matrix <- calculate_homology(tak,return_df = FALSE) 
bar <- plot_barcode(hom_matrix)
hom <- hom %>%
  mutate(persistence = death-birth) %>%
  mutate(persistent = ifelse(persistence > 0.1, 1,0))
hom_matrix <- tibble(hom) %>% select(dimension, persistent)
hom_matrix <- tibble(hom_matrix) 
p1 <- hom_matrix[hom_matrix$persistent == '1',] 
text_homology<-rbind.data.frame(text_homology,p1)
bar
}
```

